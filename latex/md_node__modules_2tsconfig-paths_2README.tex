\chapter{tsconfig-\/paths}
\hypertarget{md_node__modules_2tsconfig-paths_2README}{}\label{md_node__modules_2tsconfig-paths_2README}\index{tsconfig-\/paths@{tsconfig-\/paths}}
\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28643}%
\Hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28643}%
 \href{https://www.npmjs.com/package/tsconfig-paths}{\texttt{ }} \href{https://github.com/dividab/tsconfig-paths/actions/workflows/ci.yml?query=branch\%3Amaster}{\texttt{ }} \href{https://codecov.io/gh/dividab/tsconfig-paths}{\texttt{ }} \href{https://opensource.org/licenses/MIT}{\texttt{ }} \href{https://github.com/prettier/prettier}{\texttt{ }}

Use this to load modules whose location is specified in the {\ttfamily paths} section of {\ttfamily tsconfig.\+json}. Both loading at run-\/time and via API are supported.

Typescript by default mimics the Node.\+js runtime resolution strategy of modules. But it also allows the use of \href{https://www.typescriptlang.org/docs/handbook/module-resolution.html}{\texttt{ path mapping}} which allows arbitrary module paths (that doesn\textquotesingle{}t start with "{}/"{} or "{}."{}) to be specified and mapped to physical paths in the filesystem. The typescript compiler can resolve these paths from {\ttfamily tsconfig} so it will compile OK. But if you then try to execute the compiled files with node (or ts-\/node), it will only look in the {\ttfamily node\+\_\+modules} folders all the way up to the root of the filesystem and thus will not find the modules specified by {\ttfamily paths} in {\ttfamily tsconfig}.

If you require this package\textquotesingle{}s {\ttfamily tsconfig-\/paths/register} module it will read the {\ttfamily paths} from {\ttfamily tsconfig.\+json} and convert node\textquotesingle{}s module loading calls into to physical file paths that node can load.\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28644}{}\doxysection{\texorpdfstring{How to install}{How to install}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28644}

\begin{DoxyCode}{0}
\DoxyCodeLine{yarn\ add\ -\/-\/dev\ tsconfig-\/paths}

\end{DoxyCode}


or


\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ install\ -\/-\/save-\/dev\ tsconfig-\/paths}

\end{DoxyCode}
\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28645}{}\doxysection{\texorpdfstring{How to use}{How to use}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28645}
\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28646}{}\doxysubsection{\texorpdfstring{With node}{With node}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28646}
{\ttfamily node -\/r tsconfig-\/paths/register main.\+js}

If {\ttfamily process.\+env.\+TS\+\_\+\+NODE\+\_\+\+BASEURL} is set it will override the value of {\ttfamily base\+Url} in tsconfig.\+json\+:

{\ttfamily TS\+\_\+\+NODE\+\_\+\+BASEURL=./dist node -\/r tsconfig-\/paths/register main.\+js}\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28647}{}\doxysubsection{\texorpdfstring{With ts-\/node}{With ts-node}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28647}
{\ttfamily ts-\/node -\/r tsconfig-\/paths/register main.\+ts}

If {\ttfamily process.\+env.\+TS\+\_\+\+NODE\+\_\+\+PROJECT} is set it will be used to resolved tsconfig.\+json\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28648}{}\doxysubsection{\texorpdfstring{With webpack}{With webpack}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28648}
For webpack please use the \href{https://github.com/dividab/tsconfig-paths-webpack-plugin}{\texttt{ tsconfig-\/paths-\/webpack-\/plugin}}.\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28649}{}\doxysubsection{\texorpdfstring{With mocha and ts-\/node}{With mocha and ts-node}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28649}
As of Mocha \texorpdfstring{$>$}{>}= 4.\+0.\+0 the {\ttfamily -\/-\/compiler} was \href{https://github.com/mochajs/mocha/wiki/compilers-deprecation}{\texttt{ deprecated}}. Instead {\ttfamily -\/-\/require} should be used. You also have to specify a glob that includes {\ttfamily .ts} files because mocha looks after files with {\ttfamily .js} extension by default.


\begin{DoxyCode}{0}
\DoxyCodeLine{mocha\ -\/r\ ts-\/node/register\ -\/r\ tsconfig-\/paths/register\ "{}test/**/*.ts"{}}

\end{DoxyCode}
\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28650}{}\doxysubsection{\texorpdfstring{With other commands}{With other commands}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28650}
As long as the command has something similar to a {\ttfamily -\/-\/require} option that can load a module before it starts, tsconfig-\/paths should be able to work with it.\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28651}{}\doxysubsection{\texorpdfstring{With $<$tt$>$ts-\/node$<$/tt$>$ and VSCode}{With <tt>ts-node</tt> and VSCode}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28651}
The following is an example configuration for the {\ttfamily .vscode/launch.\+json}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\{}
\DoxyCodeLine{\ \ "{}version"{}:\ "{}0.2.0"{},}
\DoxyCodeLine{\ \ "{}configurations"{}:\ [}
\DoxyCodeLine{\ \ \ \ \{}
\DoxyCodeLine{\ \ \ \ \ \ "{}name"{}:\ "{}Debug\ Functions"{},}
\DoxyCodeLine{\ \ \ \ \ \ "{}request"{}:\ "{}launch"{},}
\DoxyCodeLine{\ \ \ \ \ \ "{}type"{}:\ "{}node"{},}
\DoxyCodeLine{\ \ \ \ \ \ "{}runtimeArgs"{}:\ [}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}-\/r"{},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}\$\{workspaceFolder\}/functions/node\_modules/ts-\/node/register"{},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}-\/r"{},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}\$\{workspaceFolder\}/functions/node\_modules/tsconfig-\/paths/register"{}}
\DoxyCodeLine{\ \ \ \ \ \ ],}
\DoxyCodeLine{\ \ \ \ \ \ "{}args"{}:\ ["{}\$\{workspaceFolder\}/functions/src/index.ts"{}],}
\DoxyCodeLine{\ \ \ \ \ \ "{}cwd"{}:\ "{}\$\{workspaceFolder\}"{},}
\DoxyCodeLine{\ \ \ \ \ \ "{}protocol"{}:\ "{}inspector"{},}
\DoxyCodeLine{\ \ \ \ \ \ "{}env"{}:\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}NODE\_ENV"{}:\ "{}development"{},}
\DoxyCodeLine{\ \ \ \ \ \ \ \ "{}TS\_NODE\_PROJECT"{}:\ "{}\$\{workspaceFolder\}/functions/tsconfig.json"{}}
\DoxyCodeLine{\ \ \ \ \ \ \},}
\DoxyCodeLine{\ \ \ \ \ \ "{}outFiles"{}:\ ["{}\$\{workspaceFolder\}/functions/lib/**/*.js"{}]}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ ]}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28652}{}\doxysection{\texorpdfstring{Bootstrapping with explicit params}{Bootstrapping with explicit params}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28652}
If you want more granular control over tsconfig-\/paths you can bootstrap it. This can be useful if you for instance have compiled with {\ttfamily tsc} to another directory where {\ttfamily tsconfig.\+json} doesn\textquotesingle{}t exists.

For example, create a wrapper script called {\ttfamily tsconfig-\/paths-\/bootstrap.\+js} with the contents below\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{const\ tsConfig\ =\ require("{}./tsconfig.json"{});}
\DoxyCodeLine{const\ tsConfigPaths\ =\ require("{}tsconfig-\/paths"{});}
\DoxyCodeLine{}
\DoxyCodeLine{const\ baseUrl\ =\ "{}./"{};\ //\ Either\ absolute\ or\ relative\ path.\ If\ relative\ it's\ resolved\ to\ current\ working\ directory.}
\DoxyCodeLine{const\ cleanup\ =\ tsConfigPaths.register(\{}
\DoxyCodeLine{\ \ baseUrl,}
\DoxyCodeLine{\ \ paths:\ tsConfig.compilerOptions.paths,}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{//\ When\ path\ registration\ is\ no\ longer\ needed}
\DoxyCodeLine{cleanup();}

\end{DoxyCode}


Then run with\+:

{\ttfamily node -\/r ./tsconfig-\/paths-\/bootstrap.js main.\+js}\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28653}{}\doxysection{\texorpdfstring{Configuration Options}{Configuration Options}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28653}
You can set options by passing them before the script path, via programmatic usage or via environment variables.


\begin{DoxyCode}{0}
\DoxyCodeLine{ts-\/node\ -\/-\/project\ customLocation/tsconfig.json\ -\/r\ tsconfig-\/paths/register\ "{}test/**/*.ts"{}}

\end{DoxyCode}
\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28654}{}\doxysubsection{\texorpdfstring{CLI and Programmatic Options}{CLI and Programmatic Options}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28654}
{\itshape Environment variable denoted in parentheses.}


\begin{DoxyItemize}
\item {\ttfamily -\/P, -\/-\/project \mbox{[}path\mbox{]}} Path to Type\+Script JSON project file ({\ttfamily TS\+\_\+\+NODE\+\_\+\+PROJECT})
\end{DoxyItemize}\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28655}{}\doxysection{\texorpdfstring{Config loading process}{Config loading process}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28655}

\begin{DoxyEnumerate}
\item Use explicit params passed to register
\item Use {\ttfamily process.\+env.\+TS\+\_\+\+NODE\+\_\+\+PROJECT} to resolve ts\+Config.\+json and the specified base\+Url and paths.
\item Resolves tsconfig.\+json from current working directory and the specified base\+Url and paths.
\end{DoxyEnumerate}\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28656}{}\doxysection{\texorpdfstring{Programmatic use}{Programmatic use}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28656}
The public API consists of these functions\+:


\begin{DoxyItemize}
\item register
\item load\+Config
\item create\+Match\+Path / create\+Match\+Path\+Async
\item match\+From\+Absolute\+Paths / match\+From\+Absolute\+Paths\+Async
\end{DoxyItemize}\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28657}{}\doxysubsection{\texorpdfstring{register}{register}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28657}

\begin{DoxyCode}{0}
\DoxyCodeLine{export\ interface\ ExplicitParams\ \{}
\DoxyCodeLine{\ \ baseUrl:\ string;}
\DoxyCodeLine{\ \ paths:\ \{\ [key:\ string]:\ Array<string>\ \};}
\DoxyCodeLine{\ \ mainFields?:\ Array<string>;}
\DoxyCodeLine{\ \ addMatchAll?:\ boolean;}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{/**}
\DoxyCodeLine{\ *\ Installs\ a\ custom\ module\ load\ function\ that\ can\ adhere\ to\ paths\ in\ tsconfig.}
\DoxyCodeLine{\ */}
\DoxyCodeLine{export\ function\ register(explicitParams:\ ExplicitParams):\ ()\ =>\ void;}

\end{DoxyCode}


This function will patch the node\textquotesingle{}s module loading so it will look for modules in paths specified by tsconfig.\+json. A function is returned for you to reinstate Node\textquotesingle{}s original module loading.\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28658}{}\doxysubsection{\texorpdfstring{load\+Config}{loadConfig}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28658}

\begin{DoxyCode}{0}
\DoxyCodeLine{export\ function\ loadConfig(cwd:\ string\ =\ process.cwd()):\ ConfigLoaderResult;}
\DoxyCodeLine{}
\DoxyCodeLine{export\ type\ ConfigLoaderResult\ =}
\DoxyCodeLine{\ \ |\ ConfigLoaderSuccessResult}
\DoxyCodeLine{\ \ |\ ConfigLoaderFailResult;}
\DoxyCodeLine{}
\DoxyCodeLine{export\ interface\ ConfigLoaderSuccessResult\ \{}
\DoxyCodeLine{\ \ resultType:\ "{}success"{};}
\DoxyCodeLine{\ \ absoluteBaseUrl:\ string;}
\DoxyCodeLine{\ \ paths:\ \{\ [key:\ string]:\ Array<string>\ \};}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{export\ interface\ ConfigLoaderFailResult\ \{}
\DoxyCodeLine{\ \ resultType:\ "{}failed"{};}
\DoxyCodeLine{\ \ message:\ string;}
\DoxyCodeLine{\}}

\end{DoxyCode}


This function loads the tsconfig.\+json. It will start searching from the specified {\ttfamily cwd} directory. Passing the tsconfig.\+json file directly instead of a directory also works.\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28659}{}\doxysubsection{\texorpdfstring{create\+Match\+Path}{createMatchPath}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28659}

\begin{DoxyCode}{0}
\DoxyCodeLine{/**}
\DoxyCodeLine{\ *\ Function\ that\ can\ match\ a\ path}
\DoxyCodeLine{\ */}
\DoxyCodeLine{export\ interface\ MatchPath\ \{}
\DoxyCodeLine{\ \ (}
\DoxyCodeLine{\ \ \ \ requestedModule:\ string,}
\DoxyCodeLine{\ \ \ \ readJson?:\ Filesystem.ReadJsonSync,}
\DoxyCodeLine{\ \ \ \ fileExists?:\ (name:\ string)\ =>\ boolean,}
\DoxyCodeLine{\ \ \ \ extensions?:\ ReadonlyArray<string>}
\DoxyCodeLine{\ \ ):\ string\ |\ undefined;}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{/**}
\DoxyCodeLine{\ *\ Creates\ a\ function\ that\ can\ resolve\ paths\ according\ to\ tsconfig\ paths\ property.}
\DoxyCodeLine{\ *\ @param\ absoluteBaseUrl\ Absolute\ version\ of\ baseUrl\ as\ specified\ in\ tsconfig.}
\DoxyCodeLine{\ *\ @param\ paths\ The\ paths\ as\ specified\ in\ tsconfig.}
\DoxyCodeLine{\ *\ @param\ mainFields\ A\ list\ of\ package.json\ field\ names\ to\ try\ when\ resolving\ module\ files.}
\DoxyCodeLine{\ *\ @param\ addMatchAll\ Add\ a\ match-\/all\ "{}*"{}\ rule\ if\ none\ is\ present}
\DoxyCodeLine{\ *\ @returns\ a\ function\ that\ can\ resolve\ paths.}
\DoxyCodeLine{\ */}
\DoxyCodeLine{export\ function\ createMatchPath(}
\DoxyCodeLine{\ \ absoluteBaseUrl:\ string,}
\DoxyCodeLine{\ \ paths:\ \{\ [key:\ string]:\ Array<string>\ \},}
\DoxyCodeLine{\ \ mainFields:\ string[]\ =\ ["{}main"{}],}
\DoxyCodeLine{\ \ addMatchAll:\ boolean\ =\ true}
\DoxyCodeLine{):\ MatchPath\ \{}

\end{DoxyCode}


The {\ttfamily create\+Match\+Path} function will create a function that can match paths. It accepts {\ttfamily base\+Url} and {\ttfamily paths} directly as they are specified in tsconfig and will handle resolving paths to absolute form. The created function has the signature specified by the type {\ttfamily Match\+Path} above.\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28660}{}\doxysubsection{\texorpdfstring{match\+From\+Absolute\+Paths}{matchFromAbsolutePaths}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28660}

\begin{DoxyCode}{0}
\DoxyCodeLine{/**}
\DoxyCodeLine{\ *\ Finds\ a\ path\ from\ tsconfig\ that\ matches\ a\ module\ load\ request.}
\DoxyCodeLine{\ *\ @param\ absolutePathMappings\ The\ paths\ to\ try\ as\ specified\ in\ tsconfig\ but\ resolved\ to\ absolute\ form.}
\DoxyCodeLine{\ *\ @param\ requestedModule\ The\ required\ module\ name.}
\DoxyCodeLine{\ *\ @param\ readJson\ Function\ that\ can\ read\ json\ from\ a\ path\ (useful\ for\ testing).}
\DoxyCodeLine{\ *\ @param\ fileExists\ Function\ that\ checks\ for\ existence\ of\ a\ file\ at\ a\ path\ (useful\ for\ testing).}
\DoxyCodeLine{\ *\ @param\ extensions\ File\ extensions\ to\ probe\ for\ (useful\ for\ testing).}
\DoxyCodeLine{\ *\ @param\ mainFields\ A\ list\ of\ package.json\ field\ names\ to\ try\ when\ resolving\ module\ files.}
\DoxyCodeLine{\ *\ @returns\ the\ found\ path,\ or\ undefined\ if\ no\ path\ was\ found.}
\DoxyCodeLine{\ */}
\DoxyCodeLine{export\ function\ matchFromAbsolutePaths(}
\DoxyCodeLine{\ \ absolutePathMappings:\ ReadonlyArray<MappingEntry.MappingEntry>,}
\DoxyCodeLine{\ \ requestedModule:\ string,}
\DoxyCodeLine{\ \ readJson:\ Filesystem.ReadJsonSync\ =\ Filesystem.readJsonFromDiskSync,}
\DoxyCodeLine{\ \ fileExists:\ Filesystem.FileExistsSync\ =\ Filesystem.fileExistsSync,}
\DoxyCodeLine{\ \ extensions:\ Array<string>\ =\ Object.keys(require.extensions),}
\DoxyCodeLine{\ \ mainFields:\ string[]\ =\ ["{}main"{}]}
\DoxyCodeLine{):\ string\ |\ undefined\ \{}

\end{DoxyCode}


This function is lower level and requires that the paths as already been resolved to absolute form and sorted in correct order into an array.\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28661}{}\doxysubsection{\texorpdfstring{create\+Match\+Path\+Async}{createMatchPathAsync}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28661}
This is the async version of {\ttfamily create\+Match\+Path}. It has the same signature but with a callback parameter for the result.\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28662}{}\doxysubsection{\texorpdfstring{match\+From\+Absolute\+Paths\+Async}{matchFromAbsolutePathsAsync}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28662}
This is the async version of {\ttfamily match\+From\+Absolute\+Paths}. It has the same signature but with a callback parameter for the result.\hypertarget{md_node__modules_2tsconfig-paths_2README_autotoc_md28663}{}\doxysection{\texorpdfstring{How to publish}{How to publish}}\label{md_node__modules_2tsconfig-paths_2README_autotoc_md28663}

\begin{DoxyCode}{0}
\DoxyCodeLine{yarn\ version\ -\/-\/patch}
\DoxyCodeLine{yarn\ version\ -\/-\/minor}
\DoxyCodeLine{yarn\ version\ -\/-\/major}

\end{DoxyCode}
 