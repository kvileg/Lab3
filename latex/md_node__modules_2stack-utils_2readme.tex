\chapter{stack-\/utils}
\hypertarget{md_node__modules_2stack-utils_2readme}{}\label{md_node__modules_2stack-utils_2readme}\index{stack-\/utils@{stack-\/utils}}
\label{md_node__modules_2stack-utils_2readme_autotoc_md26342}%
\Hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26342}%
 \begin{quote}
Captures and cleans stack traces. \end{quote}
\href{https://travis-ci.org/tapjs/stack-utils}{\texttt{ }} \href{https://ci.appveyor.com/project/jamestalmage/stack-utils-oiw96/branch/master}{\texttt{ }} \href{https://coveralls.io/github/tapjs/stack-utils?branch=master}{\texttt{ }}

Extracted from {\ttfamily lib/stack.\+js} in the \href{https://github.com/tapjs/node-tap}{\texttt{ {\ttfamily node-\/tap} project}}\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26343}{}\doxysection{\texorpdfstring{Install}{Install}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26343}

\begin{DoxyCode}{0}
\DoxyCodeLine{\$\ npm\ install\ -\/-\/save\ stack-\/utils}

\end{DoxyCode}
\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26344}{}\doxysection{\texorpdfstring{Usage}{Usage}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26344}

\begin{DoxyCode}{0}
\DoxyCodeLine{const\ StackUtils\ =\ require('stack-\/utils');}
\DoxyCodeLine{const\ stack\ =\ new\ StackUtils(\{cwd:\ process.cwd(),\ internals:\ StackUtils.nodeInternals()\});}
\DoxyCodeLine{}
\DoxyCodeLine{console.log(stack.clean(new\ Error().stack));}
\DoxyCodeLine{//\ outputs\ a\ beautified\ stack\ trace}

\end{DoxyCode}
\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26345}{}\doxysection{\texorpdfstring{API}{API}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26345}
\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26346}{}\doxysubsection{\texorpdfstring{new Stack\+Utils(\mbox{[}options\mbox{]})}{new StackUtils([options])}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26346}
Creates a new {\ttfamily stack\+Utils} instance.\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26347}{}\doxysubsubsection{\texorpdfstring{options}{options}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26347}
\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26348}{}\doxyparagraph{\texorpdfstring{internals}{internals}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26348}
Type\+: {\ttfamily array} of {\ttfamily Regular\+Expression}s ~\newline


A set of regular expressions that match internal stack stack trace lines which should be culled from the stack trace. The default is {\ttfamily Stack\+Utils.\+node\+Internals()}, this can be disabled by setting {\ttfamily \mbox{[}\mbox{]}} or appended using {\ttfamily Stack\+Utils.\+node\+Internals().concat(additional\+Reg\+Exp)}. See also {\ttfamily ignored\+Packages}.\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26349}{}\doxyparagraph{\texorpdfstring{ignored\+Packages}{ignoredPackages}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26349}
Type\+: {\ttfamily array} of {\ttfamily string}s

An array of npm modules to be culled from the stack trace. This list will mapped to regular expressions and merged with the {\ttfamily internals}.

Default `'\textquotesingle{}\`{}.\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26350}{}\doxyparagraph{\texorpdfstring{cwd}{cwd}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26350}
Type\+: {\ttfamily string}

The path to the current working directory. File names in the stack trace will be shown relative to this directory.\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26351}{}\doxyparagraph{\texorpdfstring{wrap\+Call\+Site}{wrapCallSite}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26351}
Type\+: {\ttfamily function(\+Call\+Site)}

A mapping function for manipulating Call\+Sites before processing. The first argument is a Call\+Site instance, and the function should return a modified Call\+Site. This is useful for providing source map support.\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26352}{}\doxysubsection{\texorpdfstring{Stack\+Utils.\+node\+Internals()}{StackUtils.nodeInternals()}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26352}
Returns an array of regular expressions that be used to cull lines from the stack trace that reference common Node.\+js internal files.\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26353}{}\doxysubsection{\texorpdfstring{stack\+Utils.\+clean(stack, indent = 0)}{stackUtils.clean(stack, indent = 0)}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26353}
Cleans up a stack trace by deleting any lines that match the {\ttfamily internals} passed to the constructor, and shortening file names relative to {\ttfamily cwd}.

Returns a {\ttfamily string} with the cleaned up stack (always terminated with a {\ttfamily \textbackslash{}n} newline character). Spaces at the start of each line are trimmed, indentation can be added by setting {\ttfamily indent} to the desired number of spaces.\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26354}{}\doxysubsubsection{\texorpdfstring{stack}{stack}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26354}
{\itshape Required} ~\newline
 Type\+: {\ttfamily string} or an {\ttfamily array} of {\ttfamily string}s\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26355}{}\doxysubsection{\texorpdfstring{stack\+Utils.\+capture(\mbox{[}limit\mbox{]}, \mbox{[}start\+Stack\+Function\mbox{]})}{stackUtils.capture([limit], [startStackFunction])}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26355}
Captures the current stack trace, returning an array of {\ttfamily Call\+Site}s. There are good overviews of the available Call\+Site methods \href{https://github.com/v8/v8/wiki/Stack\%20Trace\%20API\#customizing-stack-traces}{\texttt{ here}}, and \href{https://github.com/sindresorhus/callsites\#api}{\texttt{ here}}.\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26356}{}\doxysubsubsection{\texorpdfstring{limit}{limit}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26356}
Type\+: {\ttfamily number} Default\+: {\ttfamily Infinity}

Limits the number of lines returned by dropping all lines in excess of the limit. This removes lines from the stack trace.\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26357}{}\doxysubsubsection{\texorpdfstring{start\+Stack\+Function}{startStackFunction}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26357}
Type\+: {\ttfamily function}

The function where the stack trace should start. The first line of the stack trace will be the function that called {\ttfamily start\+Stack\+Function}. This removes lines from the end of the stack trace.\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26358}{}\doxysubsection{\texorpdfstring{stack\+Utils.\+capture\+String(\mbox{[}limit\mbox{]}, \mbox{[}start\+Stack\+Function\mbox{]})}{stackUtils.captureString([limit], [startStackFunction])}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26358}
Captures the current stack trace, cleans it using {\ttfamily stack\+Utils.\+clean(stack)}, and returns a string with the cleaned stack trace. It takes the same arguments as {\ttfamily stack\+Utils.\+capture}.\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26359}{}\doxysubsection{\texorpdfstring{stack\+Utils.\+at(\mbox{[}start\+Stack\+Function\mbox{]})}{stackUtils.at([startStackFunction])}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26359}
Captures the first line of the stack trace (or the first line after {\ttfamily start\+Stack\+Function} if supplied), and returns a {\ttfamily Call\+Site} like object that is serialization friendly (properties are actual values instead of getter functions).

The available properties are\+:


\begin{DoxyItemize}
\item {\ttfamily line}\+: {\ttfamily number}
\item {\ttfamily column}\+: {\ttfamily number}
\item {\ttfamily file}\+: {\ttfamily string}
\item {\ttfamily constructor}\+: {\ttfamily boolean}
\item {\ttfamily eval\+Origin}\+: {\ttfamily string}
\item {\ttfamily native}\+: {\ttfamily boolean}
\item {\ttfamily type}\+: {\ttfamily string}
\item {\ttfamily function}\+: {\ttfamily string}
\item {\ttfamily method}\+: {\ttfamily string}
\end{DoxyItemize}\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26360}{}\doxysubsection{\texorpdfstring{stack\+Utils.\+parse\+Line(line)}{stackUtils.parseLine(line)}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26360}
Parses a {\ttfamily string} (which should be a single line from a stack trace), and generates an object with the following properties\+:


\begin{DoxyItemize}
\item {\ttfamily line}\+: {\ttfamily number}
\item {\ttfamily column}\+: {\ttfamily number}
\item {\ttfamily file}\+: {\ttfamily string}
\item {\ttfamily constructor}\+: {\ttfamily boolean}
\item {\ttfamily eval\+Origin}\+: {\ttfamily string}
\item {\ttfamily eval\+Line}\+: {\ttfamily number}
\item {\ttfamily eval\+Column}\+: {\ttfamily number}
\item {\ttfamily eval\+File}\+: {\ttfamily string}
\item {\ttfamily native}\+: {\ttfamily boolean}
\item {\ttfamily function}\+: {\ttfamily string}
\item {\ttfamily method}\+: {\ttfamily string}
\end{DoxyItemize}\hypertarget{md_node__modules_2stack-utils_2readme_autotoc_md26361}{}\doxysection{\texorpdfstring{License}{License}}\label{md_node__modules_2stack-utils_2readme_autotoc_md26361}
MIT Â© \href{http://github.com/isaacs}{\texttt{ Isaac Z. Schlueter}}, \href{http://github.com/jamestalmage}{\texttt{ James Talmage}} 