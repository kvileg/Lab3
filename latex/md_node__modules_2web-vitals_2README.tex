\chapter{\texorpdfstring{$<$}{<}tt\texorpdfstring{$>$}{>}web-\/vitals\texorpdfstring{$<$}{<}/tt\texorpdfstring{$>$}{>}}
\hypertarget{md_node__modules_2web-vitals_2README}{}\label{md_node__modules_2web-vitals_2README}\index{$<$tt$>$web-\/vitals$<$/tt$>$@{$<$tt$>$web-\/vitals$<$/tt$>$}}
\label{md_node__modules_2web-vitals_2README_autotoc_md29317}%
\Hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29317}%

\begin{DoxyItemize}
\item \doxylink{md_node__modules_2safer-buffer_2Porting-Buffer_overview}{Overview}
\item \doxylink{md_node__modules_2web-vitals_2README_installation}{Install and load the library}
\begin{DoxyItemize}
\item \doxylink{md_node__modules_2web-vitals_2README_import-web-vitals-from-npm}{From npm}
\item \doxylink{md_node__modules_2web-vitals_2README_load-web-vitals-from-a-cdn}{From a CDN}
\end{DoxyItemize}
\item \doxylink{md_node__modules_2_0dtypes_2jest_2node__modules_2_0dsinclair_2typebox_2readme_usage}{Usage}
\begin{DoxyItemize}
\item Basic usage
\item Report the value on every change
\item Report only the delta of changes
\item Send the results to an analytics endpoint
\item Send the results to Google Analytics
\item Send the results to Google Tag Manager
\item Batch multiple reports together
\end{DoxyItemize}
\item Bundle versions
\begin{DoxyItemize}
\item Which bundle is right for you?
\item How the polyfill works
\end{DoxyItemize}
\item API
\begin{DoxyItemize}
\item \doxylink{md_node__modules_2_0dtypes_2jest_2node__modules_2_0dsinclair_2typebox_2readme_types}{Types}
\item Functions
\end{DoxyItemize}
\item Browser Support
\item Limitations
\item Development
\item Integrations
\item License
\end{DoxyItemize}\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29318}{}\doxysection{\texorpdfstring{Overview}{Overview}}\label{md_node__modules_2web-vitals_2README_autotoc_md29318}
The {\ttfamily web-\/vitals} library is a tiny (\texorpdfstring{$\sim$}{\string~}1K), modular library for measuring all the \href{https://web.dev/vitals/}{\texttt{ Web Vitals}} metrics on real users, in a way that accurately matches how they\textquotesingle{}re measured by Chrome and reported to other Google tools (e.\+g. \href{https://developers.google.com/web/tools/chrome-user-experience-report}{\texttt{ Chrome User Experience Report}}, \href{https://developers.google.com/speed/pagespeed/insights/}{\texttt{ Page Speed Insights}}, \href{https://webmasters.googleblog.com/2019/11/search-console-speed-report.html}{\texttt{ Search Console\textquotesingle{}s Speed Report}}).

The library supports all of the \href{https://web.dev/vitals/\#core-web-vitals}{\texttt{ Core Web Vitals}} as well as all of the \href{https://web.dev/vitals/\#other-web-vitals}{\texttt{ other Web Vitals}} that can be measured \href{https://web.dev/user-centric-performance-metrics/\#how-metrics-are-measured}{\texttt{ in the field}}\+:\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29319}{}\doxysubsection{\texorpdfstring{Core Web Vitals}{Core Web Vitals}}\label{md_node__modules_2web-vitals_2README_autotoc_md29319}

\begin{DoxyItemize}
\item \href{https://web.dev/cls/}{\texttt{ Cumulative Layout Shift (CLS)}}
\item \href{https://web.dev/fid/}{\texttt{ First Input Delay (FID)}}
\item \href{https://web.dev/lcp/}{\texttt{ Largest Contentful Paint (LCP)}}
\end{DoxyItemize}\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29320}{}\doxysubsection{\texorpdfstring{Other Web Vitals}{Other Web Vitals}}\label{md_node__modules_2web-vitals_2README_autotoc_md29320}

\begin{DoxyItemize}
\item \href{https://web.dev/fcp/}{\texttt{ First Contentful Paint (FCP)}}
\item \href{https://web.dev/ttfb/}{\texttt{ Time to First Byte (TTFB)}}
\end{DoxyItemize}

\label{md_node__modules_2web-vitals_2README_installation}%
\Hypertarget{md_node__modules_2web-vitals_2README_installation}%
 \label{md_node__modules_2web-vitals_2README_load-the-library}%
\Hypertarget{md_node__modules_2web-vitals_2README_load-the-library}%
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29321}{}\doxysection{\texorpdfstring{Install and load the library}{Install and load the library}}\label{md_node__modules_2web-vitals_2README_autotoc_md29321}
\label{md_node__modules_2web-vitals_2README_import-web-vitals-from-npm}%
\Hypertarget{md_node__modules_2web-vitals_2README_import-web-vitals-from-npm}%
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29322}{}\doxysubsection{\texorpdfstring{From npm}{From npm}}\label{md_node__modules_2web-vitals_2README_autotoc_md29322}
You can install this library from npm by running\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ install\ web-\/vitals}

\end{DoxyCode}


{\itshape {\bfseries{Note\+:}} If you\textquotesingle{}re not using npm, you can still load {\ttfamily web-\/vitals} via {\ttfamily \texorpdfstring{$<$}{<}script\texorpdfstring{$>$}{>}} tags from a CDN like \href{https://unpkg.com}{\texttt{ unpkg.\+com}}. See the \doxylink{md_node__modules_2web-vitals_2README_load-web-vitals-from-a-cdn}{load \`{}web-\/vitals\`{} from a CDN} usage example below for details.}

There are two different versions of the {\ttfamily web-\/vitals} library (the "{}standard"{} version and the "{}base+polyfill"{} version), and how you load the library depends on which version you want to use.

For details on the difference between the two versions, see \href{\#which-bundle-is-right-for-you}{\texttt{ which bundle is right for you}}.

{\bfseries{1. The "{}standard"{} version}}

To load the "{}standard"{} version, import modules from the {\ttfamily web-\/vitals} package in your application code (as you would with any npm package and node-\/based build tool)\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{getLCP,\ getFID,\ getCLS\}\ from\ 'web-\/vitals';}
\DoxyCodeLine{}
\DoxyCodeLine{getCLS(console.log);}
\DoxyCodeLine{getFID(console.log);}
\DoxyCodeLine{getLCP(console.log);}

\end{DoxyCode}


\label{md_node__modules_2web-vitals_2README_how-to-use-the-polyfill}%
\Hypertarget{md_node__modules_2web-vitals_2README_how-to-use-the-polyfill}%


{\bfseries{2. The "{}base+polyfill"{} version}}

Loading the "{}base+polyfill"{} version is a two-\/step process\+:

First, in your application code, import the "{}base"{} build rather than the "{}standard"{} build. To do this, change any {\ttfamily import} statements that reference {\ttfamily web-\/vitals} to {\ttfamily web-\/vitals/base}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{-\/\ import\ \{getLCP,\ getFID,\ getCLS\}\ from\ 'web-\/vitals';}
\DoxyCodeLine{+\ import\ \{getLCP,\ getFID,\ getCLS\}\ from\ 'web-\/vitals/base';}

\end{DoxyCode}


Then, inline the code from {\ttfamily dist/polyfill.\+js} into the {\ttfamily \texorpdfstring{$<$}{<}head\texorpdfstring{$>$}{>}} of your pages. This step is important since the "{}base"{} build will error if the polyfill code has not been added.


\begin{DoxyCode}{0}
\DoxyCodeLine{<!DOCTYPE\ html>}
\DoxyCodeLine{<html>}
\DoxyCodeLine{\ \ <head>}
\DoxyCodeLine{\ \ \ \ <script>}
\DoxyCodeLine{\ \ \ \ \ \ //\ Inline\ code\ from\ \`{}dist/polyfill.js`\ here}
\DoxyCodeLine{\ \ \ \ </script>}
\DoxyCodeLine{\ \ </head>}
\DoxyCodeLine{\ \ <body>}
\DoxyCodeLine{\ \ \ \ ...}
\DoxyCodeLine{\ \ </body>}
\DoxyCodeLine{</html>}

\end{DoxyCode}


Note that the code {\itshape must} go in the {\ttfamily \texorpdfstring{$<$}{<}head\texorpdfstring{$>$}{>}} of your pages in order to work. See how the polyfill works for more details.

{\itshape {\bfseries{Tip\+:}} while it\textquotesingle{}s certainly possible to inline the code in {\ttfamily dist/polyfill.\+js} by copy and pasting it directly into your templates, it\textquotesingle{}s better to automate this process in a build stepâ€”otherwise you risk the "{}base"{} and the "{}polyfill"{} scripts getting out of sync when new versions are released.}

\label{md_node__modules_2web-vitals_2README_load-web-vitals-from-a-cdn}%
\Hypertarget{md_node__modules_2web-vitals_2README_load-web-vitals-from-a-cdn}%
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29323}{}\doxysubsection{\texorpdfstring{From a CDN}{From a CDN}}\label{md_node__modules_2web-vitals_2README_autotoc_md29323}
The recommended way to use the {\ttfamily web-\/vitals} package is to install it from npm and integrate it into your build process. However, if you\textquotesingle{}re not using npm, it\textquotesingle{}s still possible to use {\ttfamily web-\/vitals} by requesting it from a CDN that serves npm package files.

The following examples show how to load {\ttfamily web-\/vitals} from \href{https://unpkg.com}{\texttt{ unpkg.\+com}}, whether your targeting just Chromium-\/based browsers (using the "{}standard"{} version) or additional browsers (using the "{}base+polyfill"{} version)\+:

{\bfseries{Load the "{}standard"{} version}} \+\_\+(using a module script)\+\_\+


\begin{DoxyCode}{0}
\DoxyCodeLine{<!-\/-\/\ Append\ the\ \`{}?module`\ param\ to\ load\ the\ module\ version\ of\ \`{}web-\/vitals`\ -\/-\/>}
\DoxyCodeLine{<script\ type="{}module"{}>}
\DoxyCodeLine{\ \ import\ \{getCLS,\ getFID,\ getLCP\}\ from\ 'https://unpkg.com/web-\/vitals?module';}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ getCLS(console.log);}
\DoxyCodeLine{\ \ getFID(console.log);}
\DoxyCodeLine{\ \ getLCP(console.log);}
\DoxyCodeLine{</script>}

\end{DoxyCode}


{\bfseries{Load the "{}standard"{} version}} \+\_\+(using a classic script)\+\_\+


\begin{DoxyCode}{0}
\DoxyCodeLine{<script>}
\DoxyCodeLine{(function()\ \{}
\DoxyCodeLine{\ \ var\ script\ =\ document.createElement('script');}
\DoxyCodeLine{\ \ script.src\ =\ 'https://unpkg.com/web-\/vitals/dist/web-\/vitals.iife.js';}
\DoxyCodeLine{\ \ script.onload\ =\ function()\ \{}
\DoxyCodeLine{\ \ \ \ //\ When\ loading\ \`{}web-\/vitals`\ using\ a\ classic\ script,\ all\ the\ public}
\DoxyCodeLine{\ \ \ \ //\ methods\ can\ be\ found\ on\ the\ \`{}webVitals`\ global\ namespace.}
\DoxyCodeLine{\ \ \ \ webVitals.getCLS(console.log);}
\DoxyCodeLine{\ \ \ \ webVitals.getFID(console.log);}
\DoxyCodeLine{\ \ \ \ webVitals.getLCP(console.log);}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\ \ document.head.appendChild(script);}
\DoxyCodeLine{\}())}
\DoxyCodeLine{</script>}

\end{DoxyCode}


{\bfseries{Load the "{}base+polyfill"{} version}} \+\_\+(using a classic script)\+\_\+


\begin{DoxyCode}{0}
\DoxyCodeLine{<!DOCTYPE\ html>}
\DoxyCodeLine{<html>}
\DoxyCodeLine{\ \ <head>}
\DoxyCodeLine{\ \ \ \ <script>}
\DoxyCodeLine{\ \ \ \ \ \ //\ Inline\ code\ from\ \`{}https://unpkg.com/web-\/vitals/dist/polyfill.js`\ here.}
\DoxyCodeLine{\ \ \ \ </script>}
\DoxyCodeLine{\ \ </head>}
\DoxyCodeLine{\ \ <body>}
\DoxyCodeLine{\ \ \ \ ...}
\DoxyCodeLine{\ \ \ \ <!-\/-\/\ Load\ the\ UMD\ version\ of\ the\ "{}base"{}\ bundle.\ -\/-\/>}
\DoxyCodeLine{\ \ \ \ <script>}
\DoxyCodeLine{\ \ \ \ (function()\ \{}
\DoxyCodeLine{\ \ \ \ \ \ var\ script\ =\ document.createElement('script');}
\DoxyCodeLine{\ \ \ \ \ \ script.src\ =\ 'https://unpkg.com/web-\/vitals/dist/web-\/vitals.base.iife.js';}
\DoxyCodeLine{\ \ \ \ \ \ script.onload\ =\ function()\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ //\ When\ loading\ \`{}web-\/vitals`\ using\ a\ classic\ script,\ all\ the\ public}
\DoxyCodeLine{\ \ \ \ \ \ \ \ //\ methods\ can\ be\ found\ on\ the\ \`{}webVitals`\ global\ namespace.}
\DoxyCodeLine{\ \ \ \ \ \ \ \ webVitals.getCLS(console.log);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ webVitals.getFID(console.log);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ webVitals.getLCP(console.log);}
\DoxyCodeLine{\ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ document.head.appendChild(script);}
\DoxyCodeLine{\ \ \ \ \}())}
\DoxyCodeLine{\ \ \ \ </script>}
\DoxyCodeLine{\ \ </body>}
\DoxyCodeLine{</html>}

\end{DoxyCode}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29324}{}\doxysection{\texorpdfstring{Usage}{Usage}}\label{md_node__modules_2web-vitals_2README_autotoc_md29324}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29325}{}\doxysubsection{\texorpdfstring{Basic usage}{Basic usage}}\label{md_node__modules_2web-vitals_2README_autotoc_md29325}
Each of the Web Vitals metrics is exposed as a single function that takes an {\ttfamily on\+Report} callback. This callback will be called any time the metric value is available and ready to be reported.

The following example measures each of the Core Web Vitals metrics and logs the result to the console once its value is ready to report.

\+\_\+(The examples below import the "{}standard"{} version, but they will work with the polyfill version as well.)\+\_\+


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{getCLS,\ getFID,\ getLCP\}\ from\ 'web-\/vitals';}
\DoxyCodeLine{}
\DoxyCodeLine{getCLS(console.log);}
\DoxyCodeLine{getFID(console.log);}
\DoxyCodeLine{getLCP(console.log);}

\end{DoxyCode}


Note that some of these metrics will not report until the user has interacted with the page, switched tabs, or the page starts to unload. If you don\textquotesingle{}t see the values logged to the console immediately, try reloading the page (with \href{https://developers.google.com/web/tools/chrome-devtools/console/reference\#persist}{\texttt{ preserve log}} enabled) or switching tabs and then switching back.

Also, in some cases a metric callback may never be called\+:


\begin{DoxyItemize}
\item FID is not reported if the user never interacts with the page.
\item FCP, FID, and LCP are not reported if the page was loaded in the background.
\end{DoxyItemize}

In other cases, a metric callback may be called more than once\+:


\begin{DoxyItemize}
\item CLS should be reported any time the \href{https://developers.google.com/web/updates/2018/07/page-lifecycle-api\#advice-hidden}{\texttt{ page\textquotesingle{}s {\ttfamily visibility\+State} changes to hidden}}.
\item CLS, FCP, FID, and LCP are reported again after a page is restored from the \href{https://web.dev/bfcache/}{\texttt{ back/forward cache}}.
\end{DoxyItemize}

{\itshape {\bfseries{Warning\+:}} do not call any of the Web Vitals functions (e.\+g. {\ttfamily get\+CLS()}, {\ttfamily get\+FID()}, {\ttfamily get\+LCP()}) more than once per page load. Each of these functions creates a {\ttfamily Performance\+Observer} instance and registers event listeners for the lifetime of the page. While the overhead of calling these functions once is negligible, calling them repeatedly on the same page may eventually result in a memory leak.}\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29326}{}\doxysubsection{\texorpdfstring{Report the value on every change}{Report the value on every change}}\label{md_node__modules_2web-vitals_2README_autotoc_md29326}
In most cases, you only want {\ttfamily on\+Report} to be called when the metric is ready to be reported. However, it is possible to report every change (e.\+g. each layout shift as it happens) by setting the optional, second argument ({\ttfamily report\+All\+Changes}) to {\ttfamily true}.

This can be useful when debugging, but in general using {\ttfamily report\+All\+Changes} is not needed (or recommended).


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{getCLS\}\ from\ 'web-\/vitals';}
\DoxyCodeLine{}
\DoxyCodeLine{//\ Logs\ CLS\ as\ the\ value\ changes.}
\DoxyCodeLine{getCLS(console.log,\ true);}

\end{DoxyCode}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29327}{}\doxysubsection{\texorpdfstring{Report only the delta of changes}{Report only the delta of changes}}\label{md_node__modules_2web-vitals_2README_autotoc_md29327}
Some analytics providers allow you to update the value of a metric, even after you\textquotesingle{}ve already sent it to their servers (overwriting the previously-\/sent value with the same {\ttfamily id}).

Other analytics providers, however, do not allow this, so instead of reporting the new value, you need to report only the delta (the difference between the current value and the last-\/reported value). You can then compute the total value by summing all metric deltas sent with the same ID.

The following example shows how to use the {\ttfamily id} and {\ttfamily delta} properties\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{getCLS,\ getFID,\ getLCP\}\ from\ 'web-\/vitals';}
\DoxyCodeLine{}
\DoxyCodeLine{function\ logDelta(\{name,\ id,\ delta\})\ \{}
\DoxyCodeLine{\ \ console.log(`\$\{name\}\ matching\ ID\ \$\{id\}\ changed\ by\ \$\{delta\}`);}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{getCLS(logDelta);}
\DoxyCodeLine{getFID(logDelta);}
\DoxyCodeLine{getLCP(logDelta);}

\end{DoxyCode}


{\itshape {\bfseries{Note\+:}} the first time the {\ttfamily on\+Report} function is called, its {\ttfamily value} and {\ttfamily delta} properties will be the same.}

In addition to using the {\ttfamily id} field to group multiple deltas for the same metric, it can also be used to differentiate different metrics reported on the same page. For example, after a back/forward cache restore, a new metric object is created with a new {\ttfamily id} (since back/forward cache restores are considered separate page visits).\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29328}{}\doxysubsection{\texorpdfstring{Send the results to an analytics endpoint}{Send the results to an analytics endpoint}}\label{md_node__modules_2web-vitals_2README_autotoc_md29328}
The following example measures each of the Core Web Vitals metrics and reports them to a hypothetical {\ttfamily /analytics} endpoint, as soon as each is ready to be sent.

The {\ttfamily send\+To\+Analytics()} function uses the \href{https://developer.mozilla.org/en-US/docs/Web/API/Navigator/sendBeacon}{\texttt{ {\ttfamily navigator.\+send\+Beacon()}}} method (if available), but falls back to the \href{https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API}{\texttt{ {\ttfamily fetch()}}} API when not.


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{getCLS,\ getFID,\ getLCP\}\ from\ 'web-\/vitals';}
\DoxyCodeLine{}
\DoxyCodeLine{function\ sendToAnalytics(metric)\ \{}
\DoxyCodeLine{\ \ //\ Replace\ with\ whatever\ serialization\ method\ you\ prefer.}
\DoxyCodeLine{\ \ //\ Note:\ JSON.stringify\ will\ likely\ include\ more\ data\ than\ you\ need.}
\DoxyCodeLine{\ \ const\ body\ =\ JSON.stringify(metric);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ //\ Use\ \`{}navigator.sendBeacon()`\ if\ available,\ falling\ back\ to\ \`{}fetch()`.}
\DoxyCodeLine{\ \ (navigator.sendBeacon\ \&\&\ navigator.sendBeacon('/analytics',\ body))\ ||}
\DoxyCodeLine{\ \ \ \ \ \ fetch('/analytics',\ \{body,\ method:\ 'POST',\ keepalive:\ true\});}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{getCLS(sendToAnalytics);}
\DoxyCodeLine{getFID(sendToAnalytics);}
\DoxyCodeLine{getLCP(sendToAnalytics);}

\end{DoxyCode}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29329}{}\doxysubsection{\texorpdfstring{Send the results to Google Analytics}{Send the results to Google Analytics}}\label{md_node__modules_2web-vitals_2README_autotoc_md29329}
Google Analytics does not support reporting metric distributions in any of its built-\/in reports; however, if you set a unique dimension value (in this case, the metric {\ttfamily id}, as shown in the examples below) on every metric instance that you send to Google Analytics, you can create a report yourself using the \href{https://developers.google.com/analytics/devguides/reporting}{\texttt{ Google Analytics Reporting API}} and any data visualization library you choose.

As an example of this, the \href{https://github.com/GoogleChromeLabs/web-vitals-report}{\texttt{ Web Vitals Report}} is a free and open-\/source tool you can use to create visualizations of the Web Vitals data that you\textquotesingle{}ve sent to Google Analytics.

\href{https://github.com/GoogleChromeLabs/web-vitals-report}{\texttt{ }}

In order to use the \href{https://github.com/GoogleChromeLabs/web-vitals-report}{\texttt{ Web Vitals Report}} (or build your own custom reports using the API) you need to send your data to Google Analytics following one of the examples outlined below\+:\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29330}{}\doxysubsubsection{\texorpdfstring{Using $<$tt$>$analytics.\+js$<$/tt$>$}{Using <tt>analytics.js</tt>}}\label{md_node__modules_2web-vitals_2README_autotoc_md29330}

\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{getCLS,\ getFID,\ getLCP\}\ from\ 'web-\/vitals';}
\DoxyCodeLine{}
\DoxyCodeLine{function\ sendToGoogleAnalytics(\{name,\ delta,\ id\})\ \{}
\DoxyCodeLine{\ \ //\ Assumes\ the\ global\ \`{}ga()`\ function\ exists,\ see:}
\DoxyCodeLine{\ \ //\ https://developers.google.com/analytics/devguides/collection/analyticsjs}
\DoxyCodeLine{\ \ ga('send',\ 'event',\ \{}
\DoxyCodeLine{\ \ \ \ eventCategory:\ 'Web\ Vitals',}
\DoxyCodeLine{\ \ \ \ eventAction:\ name,}
\DoxyCodeLine{\ \ \ \ //\ The\ \`{}id`\ value\ will\ be\ unique\ to\ the\ current\ page\ load.\ When\ sending}
\DoxyCodeLine{\ \ \ \ //\ multiple\ values\ from\ the\ same\ page\ (e.g.\ for\ CLS),\ Google\ Analytics\ can}
\DoxyCodeLine{\ \ \ \ //\ compute\ a\ total\ by\ grouping\ on\ this\ ID\ (note:\ requires\ \`{}eventLabel`\ to}
\DoxyCodeLine{\ \ \ \ //\ be\ a\ dimension\ in\ your\ report).}
\DoxyCodeLine{\ \ \ \ eventLabel:\ id,}
\DoxyCodeLine{\ \ \ \ //\ Google\ Analytics\ metrics\ must\ be\ integers,\ so\ the\ value\ is\ rounded.}
\DoxyCodeLine{\ \ \ \ //\ For\ CLS\ the\ value\ is\ first\ multiplied\ by\ 1000\ for\ greater\ precision}
\DoxyCodeLine{\ \ \ \ //\ (note:\ increase\ the\ multiplier\ for\ greater\ precision\ if\ needed).}
\DoxyCodeLine{\ \ \ \ eventValue:\ Math.round(name\ ===\ 'CLS'\ ?\ delta\ *\ 1000\ :\ delta),}
\DoxyCodeLine{\ \ \ \ //\ Use\ a\ non-\/interaction\ event\ to\ avoid\ affecting\ bounce\ rate.}
\DoxyCodeLine{\ \ \ \ nonInteraction:\ true,}
\DoxyCodeLine{\ \ \ \ //\ Use\ \`{}sendBeacon()`\ if\ the\ browser\ supports\ it.}
\DoxyCodeLine{\ \ \ \ transport:\ 'beacon',}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ //\ OPTIONAL:\ any\ additional\ params\ or\ debug\ info\ here.}
\DoxyCodeLine{\ \ \ \ //\ See:\ https://web.dev/debug-\/web-\/vitals-\/in-\/the-\/field/}
\DoxyCodeLine{\ \ \ \ //\ dimension1:\ '...',}
\DoxyCodeLine{\ \ \ \ //\ dimension2:\ '...',}
\DoxyCodeLine{\ \ \ \ //\ ...}
\DoxyCodeLine{\ \ \});}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{getCLS(sendToGoogleAnalytics);}
\DoxyCodeLine{getFID(sendToGoogleAnalytics);}
\DoxyCodeLine{getLCP(sendToGoogleAnalytics);}

\end{DoxyCode}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29331}{}\doxysubsubsection{\texorpdfstring{Using $<$tt$>$gtag.\+js$<$/tt$>$ (\+Universal Analytics)}{Using <tt>gtag.js</tt> (Universal Analytics)}}\label{md_node__modules_2web-vitals_2README_autotoc_md29331}

\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{getCLS,\ getFID,\ getLCP\}\ from\ 'web-\/vitals';}
\DoxyCodeLine{}
\DoxyCodeLine{function\ sendToGoogleAnalytics(\{name,\ delta,\ id\})\ \{}
\DoxyCodeLine{\ \ //\ Assumes\ the\ global\ \`{}gtag()`\ function\ exists,\ see:}
\DoxyCodeLine{\ \ //\ https://developers.google.com/analytics/devguides/collection/gtagjs}
\DoxyCodeLine{\ \ gtag('event',\ name,\ \{}
\DoxyCodeLine{\ \ \ \ event\_category:\ 'Web\ Vitals',}
\DoxyCodeLine{\ \ \ \ //\ The\ \`{}id`\ value\ will\ be\ unique\ to\ the\ current\ page\ load.\ When\ sending}
\DoxyCodeLine{\ \ \ \ //\ multiple\ values\ from\ the\ same\ page\ (e.g.\ for\ CLS),\ Google\ Analytics\ can}
\DoxyCodeLine{\ \ \ \ //\ compute\ a\ total\ by\ grouping\ on\ this\ ID\ (note:\ requires\ \`{}eventLabel`\ to}
\DoxyCodeLine{\ \ \ \ //\ be\ a\ dimension\ in\ your\ report).}
\DoxyCodeLine{\ \ \ \ event\_label:\ id,}
\DoxyCodeLine{\ \ \ \ //\ Google\ Analytics\ metrics\ must\ be\ integers,\ so\ the\ value\ is\ rounded.}
\DoxyCodeLine{\ \ \ \ //\ For\ CLS\ the\ value\ is\ first\ multiplied\ by\ 1000\ for\ greater\ precision}
\DoxyCodeLine{\ \ \ \ //\ (note:\ increase\ the\ multiplier\ for\ greater\ precision\ if\ needed).}
\DoxyCodeLine{\ \ \ \ value:\ Math.round(name\ ===\ 'CLS'\ ?\ delta\ *\ 1000\ :\ delta),}
\DoxyCodeLine{\ \ \ \ //\ Use\ a\ non-\/interaction\ event\ to\ avoid\ affecting\ bounce\ rate.}
\DoxyCodeLine{\ \ \ \ non\_interaction:\ true,}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ //\ OPTIONAL:\ any\ additional\ params\ or\ debug\ info\ here.}
\DoxyCodeLine{\ \ \ \ //\ See:\ https://web.dev/debug-\/web-\/vitals-\/in-\/the-\/field/}
\DoxyCodeLine{\ \ \ \ //\ metric\_rating:\ 'good'\ |\ 'ni'\ |\ 'poor',}
\DoxyCodeLine{\ \ \ \ //\ debug\_info:\ '...',}
\DoxyCodeLine{\ \ \ \ //\ ...}
\DoxyCodeLine{\ \ \});}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{getCLS(sendToGoogleAnalytics);}
\DoxyCodeLine{getFID(sendToGoogleAnalytics);}
\DoxyCodeLine{getLCP(sendToGoogleAnalytics);}

\end{DoxyCode}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29332}{}\doxysubsubsection{\texorpdfstring{Using $<$tt$>$gtag.\+js$<$/tt$>$ (\+Google Analytics 4)}{Using <tt>gtag.js</tt> (Google Analytics 4)}}\label{md_node__modules_2web-vitals_2README_autotoc_md29332}
\href{https://support.google.com/analytics/answer/10089681}{\texttt{ Google Analytics 4}} introduces a new Event model allowing custom parameters instead of a fixed category, action, and label. It also supports non-\/integer values, making it easier to measure Web Vitals metrics compared to previous versions.


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{getCLS,\ getFID,\ getLCP\}\ from\ 'web-\/vitals';}
\DoxyCodeLine{}
\DoxyCodeLine{function\ sendToGoogleAnalytics(\{name,\ delta,\ value,\ id\})\ \{}
\DoxyCodeLine{\ \ //\ Assumes\ the\ global\ \`{}gtag()`\ function\ exists,\ see:}
\DoxyCodeLine{\ \ //\ https://developers.google.com/analytics/devguides/collection/ga4}
\DoxyCodeLine{\ \ gtag('event',\ name,\ \{}
\DoxyCodeLine{\ \ \ \ //\ Built-\/in\ params:}
\DoxyCodeLine{\ \ \ \ value:\ delta,\ //\ Use\ \`{}delta`\ so\ the\ value\ can\ be\ summed.}
\DoxyCodeLine{\ \ \ \ //\ Custom\ params:}
\DoxyCodeLine{\ \ \ \ metric\_id:\ id,\ //\ Needed\ to\ aggregate\ events.}
\DoxyCodeLine{\ \ \ \ metric\_value:\ value,\ //\ Optional.}
\DoxyCodeLine{\ \ \ \ metric\_delta:\ delta,\ //\ Optional.}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ //\ OPTIONAL:\ any\ additional\ params\ or\ debug\ info\ here.}
\DoxyCodeLine{\ \ \ \ //\ See:\ https://web.dev/debug-\/web-\/vitals-\/in-\/the-\/field/}
\DoxyCodeLine{\ \ \ \ //\ metric\_rating:\ 'good'\ |\ 'ni'\ |\ 'poor',}
\DoxyCodeLine{\ \ \ \ //\ debug\_info:\ '...',}
\DoxyCodeLine{\ \ \ \ //\ ...}
\DoxyCodeLine{\ \ \});}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{getCLS(sendToGoogleAnalytics);}
\DoxyCodeLine{getFID(sendToGoogleAnalytics);}
\DoxyCodeLine{getLCP(sendToGoogleAnalytics);}

\end{DoxyCode}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29333}{}\doxysubsection{\texorpdfstring{Send the results to Google Tag Manager}{Send the results to Google Tag Manager}}\label{md_node__modules_2web-vitals_2README_autotoc_md29333}
The recommended way to measure Web Vitals metrics with Google Tag Manager is using the \href{https://www.simoahava.com/custom-templates/core-web-vitals/}{\texttt{ Core Web Vitals}} custom template tag created and maintained by \href{https://www.simoahava.com/}{\texttt{ Simo Ahava}}.

For full installation and usage instructions, see Simo\textquotesingle{}s post\+: \href{https://www.simoahava.com/analytics/track-core-web-vitals-in-ga4-with-google-tag-manager/}{\texttt{ Track Core Web Vitals in GA4 with Google Tag Manager}}.\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29334}{}\doxysubsection{\texorpdfstring{Batch multiple reports together}{Batch multiple reports together}}\label{md_node__modules_2web-vitals_2README_autotoc_md29334}
Rather than reporting each individual Web Vitals metric separately, you can minimize your network usage by batching multiple metric reports together in a single network request.

However, since not all Web Vitals metrics become available at the same time, and since not all metrics are reported on every page, you cannot simply defer reporting until all metrics are available.

Instead, you should keep a queue of all metrics that were reported and flush the queue whenever the page is backgrounded or unloaded\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{getCLS,\ getFID,\ getLCP\}\ from\ 'web-\/vitals';}
\DoxyCodeLine{}
\DoxyCodeLine{const\ queue\ =\ new\ Set();}
\DoxyCodeLine{function\ addToQueue(metric)\ \{}
\DoxyCodeLine{\ \ queue.add(metric);}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{function\ flushQueue()\ \{}
\DoxyCodeLine{\ \ if\ (queue.size\ >\ 0)\ \{}
\DoxyCodeLine{\ \ \ \ //\ Replace\ with\ whatever\ serialization\ method\ you\ prefer.}
\DoxyCodeLine{\ \ \ \ //\ Note:\ JSON.stringify\ will\ likely\ include\ more\ data\ than\ you\ need.}
\DoxyCodeLine{\ \ \ \ const\ body\ =\ JSON.stringify([...queue]);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ //\ Use\ \`{}navigator.sendBeacon()`\ if\ available,\ falling\ back\ to\ \`{}fetch()`.}
\DoxyCodeLine{\ \ \ \ (navigator.sendBeacon\ \&\&\ navigator.sendBeacon('/analytics',\ body))\ ||}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ fetch('/analytics',\ \{body,\ method:\ 'POST',\ keepalive:\ true\});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ queue.clear();}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{getCLS(addToQueue);}
\DoxyCodeLine{getFID(addToQueue);}
\DoxyCodeLine{getLCP(addToQueue);}
\DoxyCodeLine{}
\DoxyCodeLine{//\ Report\ all\ available\ metrics\ whenever\ the\ page\ is\ backgrounded\ or\ unloaded.}
\DoxyCodeLine{addEventListener('visibilitychange',\ ()\ =>\ \{}
\DoxyCodeLine{\ \ if\ (document.visibilityState\ ===\ 'hidden')\ \{}
\DoxyCodeLine{\ \ \ \ flushQueue();}
\DoxyCodeLine{\ \ \}}
\DoxyCodeLine{\});}
\DoxyCodeLine{}
\DoxyCodeLine{//\ NOTE:\ Safari\ does\ not\ reliably\ fire\ the\ \`{}visibilitychange`\ event\ when\ the}
\DoxyCodeLine{//\ page\ is\ being\ unloaded.\ If\ Safari\ support\ is\ needed,\ you\ should\ also\ flush}
\DoxyCodeLine{//\ the\ queue\ in\ the\ \`{}pagehide`\ event.}
\DoxyCodeLine{addEventListener('pagehide',\ flushQueue);}

\end{DoxyCode}


{\itshape {\bfseries{Note\+:}} see \href{https://developers.google.com/web/updates/2018/07/page-lifecycle-api\#legacy-lifecycle-apis-to-avoid}{\texttt{ the Page Lifecycle guide}} for an explanation of why {\ttfamily visibilitychange} and {\ttfamily pagehide} are recommended over events like {\ttfamily beforeunload} and {\ttfamily unload}.}\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29335}{}\doxysection{\texorpdfstring{Bundle versions}{Bundle versions}}\label{md_node__modules_2web-vitals_2README_autotoc_md29335}
The {\ttfamily web-\/vitals} package includes builds for both the "{}standard"{} and "{}base+polyfill"{} versions, as well as different formats of each to allow developers to choose the format that best meets their needs or integrates with their architecture.

The following table lists all the bundles distributed with the {\ttfamily web-\/vitals} package on npm.

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
{\bfseries{Filename}} {\itshape (all within {\ttfamily dist/\texorpdfstring{$\ast$}{*}})}  &{\bfseries{Export}} &{\bfseries{Description}}  \\\cline{1-3}
{\ttfamily web-\/vitals.\+js} &{\ttfamily pkg.\+module} &

An ES module bundle of all metric functions, without any extra polyfills to expand browser support.

This is the "{}standard"{} version and is the simplest way to consume this library out of the box.   \\\cline{1-3}
{\ttfamily web-\/vitals.\+umd.\+js} &{\ttfamily pgk.\+main} &A UMD version of the {\ttfamily web-\/vitals.\+js} bundle (exposed on the {\ttfamily window.\+web\+Vitals.\texorpdfstring{$\ast$}{*}} namespace).   \\\cline{1-3}
{\ttfamily web-\/vitals.\+iife.\+js} &-- &An IIFE version of the {\ttfamily web-\/vitals.\+js} bundle (exposed on the {\ttfamily window.\+web\+Vitals.\texorpdfstring{$\ast$}{*}} namespace).   \\\cline{1-3}
{\ttfamily web-\/vitals.\+base.\+js} &-- &

An ES module bundle containing just the "{}base"{} part of the "{}base+polyfill"{} version.

Use this bundle if (and only if) you\textquotesingle{}ve also added the {\ttfamily polyfill.\+js} script to the {\ttfamily \texorpdfstring{$<$}{<}head\texorpdfstring{$>$}{>}} of your pages. See \href{\#how-to-use-the-polyfill}{\texttt{ how to use the polyfill}} for more details.   \\\cline{1-3}
{\ttfamily web-\/vitals.\+base.\+umd.\+js} &-- &A UMD version of the {\ttfamily web-\/vitals.\+base.\+js} bundle (exposed on the {\ttfamily window.\+web\+Vitals.\texorpdfstring{$\ast$}{*}} namespace).    \\\cline{1-3}
{\ttfamily web-\/vitals.\+base.\+iife.\+js} &-- &An IIFE version of the {\ttfamily web-\/vitals.\+base.\+js} bundle (exposed on the {\ttfamily window.\+web\+Vitals.\texorpdfstring{$\ast$}{*}} namespace).   \\\cline{1-3}
{\ttfamily polyfill.\+js} &-- &

The "{}polyfill"{} part of the "{}base+polyfill"{} version. This script should be used with either {\ttfamily web-\/vitals.\+base.\+js}, {\ttfamily web-\/vitals.\+base.\+umd.\+js}, or {\ttfamily web-\/vitals.\+base.\+iife.\+js} (it will not work with any script that doesn\textquotesingle{}t have "{}base"{} in the filename).

See \href{\#how-to-use-the-polyfill}{\texttt{ how to use the polyfill}} for more details.   \\\cline{1-3}
\end{longtabu}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29336}{}\doxysubsection{\texorpdfstring{Which bundle is right for you?}{Which bundle is right for you?}}\label{md_node__modules_2web-vitals_2README_autotoc_md29336}
Most developers will generally want to use the "{}standard"{} bundle (either the ES module or UMD version, depending on your build system), as it\textquotesingle{}s the easiest to use out of the box and integrate into existing build tools.

However, there are a few good reasons to consider using the "{}base+polyfill"{} version, for example\+:


\begin{DoxyItemize}
\item FID can be measured in all browsers.
\item CLS, FCP, FID, and LCP will be more accurate in some cases (since the polyfill detects the page\textquotesingle{}s initial {\ttfamily visibility\+State} earlier).
\end{DoxyItemize}\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29337}{}\doxysubsection{\texorpdfstring{How the polyfill works}{How the polyfill works}}\label{md_node__modules_2web-vitals_2README_autotoc_md29337}
The {\ttfamily polyfill.\+js} script adds event listeners (to track FID cross-\/browser), and it records initial page visibility state as well as the timestamp of the first visibility change to hidden (to improve the accuracy of CLS, FCP, LCP, and FID).

In order for it to work properly, the script must be the first script added to the page, and it must run before the browser renders any content to the screen. This is why it needs to be added to the {\ttfamily \texorpdfstring{$<$}{<}head\texorpdfstring{$>$}{>}} of the document.

The "{}standard"{} version of the {\ttfamily web-\/vitals} library includes some of the same logic found in {\ttfamily polyfill.\+js}. To avoid duplicating that code when using the "{}base+polyfill"{} version, the {\ttfamily web-\/vitals.\+base.\+js} bundle does not include any polyfill logic, instead it coordinates with the code in {\ttfamily polyfill.\+js}, which is why the two scripts must be used together.\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29338}{}\doxysection{\texorpdfstring{API}{API}}\label{md_node__modules_2web-vitals_2README_autotoc_md29338}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29339}{}\doxysubsection{\texorpdfstring{Types\+:}{Types:}}\label{md_node__modules_2web-vitals_2README_autotoc_md29339}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29340}{}\doxysubsubsection{\texorpdfstring{$<$tt$>$\+Metric$<$/tt$>$}{<tt>Metric</tt>}}\label{md_node__modules_2web-vitals_2README_autotoc_md29340}

\begin{DoxyCode}{0}
\DoxyCodeLine{interface\ Metric\ \{}
\DoxyCodeLine{\ \ //\ The\ name\ of\ the\ metric\ (in\ acronym\ form).}
\DoxyCodeLine{\ \ name:\ 'CLS'\ |\ 'FCP'\ |\ 'FID'\ |\ 'LCP'\ |\ 'TTFB';}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ //\ The\ current\ value\ of\ the\ metric.}
\DoxyCodeLine{\ \ value:\ number;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ //\ The\ delta\ between\ the\ current\ value\ and\ the\ last-\/reported\ value.}
\DoxyCodeLine{\ \ //\ On\ the\ first\ report,\ \`{}delta`\ and\ \`{}value`\ will\ always\ be\ the\ same.}
\DoxyCodeLine{\ \ delta:\ number;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ //\ A\ unique\ ID\ representing\ this\ particular\ metric\ that's\ specific\ to\ the}
\DoxyCodeLine{\ \ //\ current\ page.\ This\ ID\ can\ be\ used\ by\ an\ analytics\ tool\ to\ dedupe}
\DoxyCodeLine{\ \ //\ multiple\ values\ sent\ for\ the\ same\ metric,\ or\ to\ group\ multiple\ deltas}
\DoxyCodeLine{\ \ //\ together\ and\ calculate\ a\ total.}
\DoxyCodeLine{\ \ id:\ string;}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ //\ Any\ performance\ entries\ used\ in\ the\ metric\ value\ calculation.}
\DoxyCodeLine{\ \ //\ Note,\ entries\ will\ be\ added\ to\ the\ array\ as\ the\ value\ changes.}
\DoxyCodeLine{\ \ entries:\ (PerformanceEntry\ |\ FirstInputPolyfillEntry\ |\ NavigationTimingPolyfillEntry)[];}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29341}{}\doxysubsubsection{\texorpdfstring{$<$tt$>$\+Report\+Handler$<$/tt$>$}{<tt>ReportHandler</tt>}}\label{md_node__modules_2web-vitals_2README_autotoc_md29341}

\begin{DoxyCode}{0}
\DoxyCodeLine{interface\ ReportHandler\ \{}
\DoxyCodeLine{\ \ (metric:\ Metric):\ void;}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29342}{}\doxysubsubsection{\texorpdfstring{$<$tt$>$\+First\+Input\+Polyfill\+Entry$<$/tt$>$}{<tt>FirstInputPolyfillEntry</tt>}}\label{md_node__modules_2web-vitals_2README_autotoc_md29342}
When using the FID polyfill (and if the browser doesn\textquotesingle{}t natively support the Event Timing API), {\ttfamily metric.\+entries} will contain an object that polyfills the {\ttfamily Performance\+Event\+Timing} entry\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{type\ FirstInputPolyfillEntry\ =\ Omit<PerformanceEventTiming,}
\DoxyCodeLine{\ \ 'processingEnd'\ |\ 'processingEnd'\ |\ 'toJSON'>}

\end{DoxyCode}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29343}{}\doxysubsubsection{\texorpdfstring{$<$tt$>$\+First\+Input\+Polyfill\+Callback$<$/tt$>$}{<tt>FirstInputPolyfillCallback</tt>}}\label{md_node__modules_2web-vitals_2README_autotoc_md29343}

\begin{DoxyCode}{0}
\DoxyCodeLine{interface\ FirstInputPolyfillCallback\ \{}
\DoxyCodeLine{\ \ (entry:\ FirstInputPolyfillEntry):\ void;}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29344}{}\doxysubsubsection{\texorpdfstring{$<$tt$>$\+Navigation\+Timing\+Polyfill\+Entry$<$/tt$>$}{<tt>NavigationTimingPolyfillEntry</tt>}}\label{md_node__modules_2web-vitals_2README_autotoc_md29344}
When calling {\ttfamily get\+TTFB()}, if the browser doesn\textquotesingle{}t support the \href{https://www.w3.org/TR/navigation-timing-2/}{\texttt{ Navigation Timing API Level 2}} interface, it will polyfill the entry object using timings from {\ttfamily performance.\+timing}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{export\ type\ NavigationTimingPolyfillEntry\ =\ Omit<PerformanceNavigationTiming,}
\DoxyCodeLine{\ \ 'initiatorType'\ |\ 'nextHopProtocol'\ |\ 'redirectCount'\ |\ 'transferSize'\ |}
\DoxyCodeLine{\ \ 'encodedBodySize'\ |\ 'decodedBodySize'\ |\ 'toJSON'>}

\end{DoxyCode}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29345}{}\doxysubsubsection{\texorpdfstring{$<$tt$>$\+Web\+Vitals\+Global$<$/tt$>$}{<tt>WebVitalsGlobal</tt>}}\label{md_node__modules_2web-vitals_2README_autotoc_md29345}
If using the "{}base+polyfill"{} build, the {\ttfamily polyfill.\+js} script creates the global {\ttfamily web\+Vitals} namespace matching the following interface\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{interface\ WebVitalsGlobal\ \{}
\DoxyCodeLine{\ \ firstInputPolyfill:\ (onFirstInput:\ FirstInputPolyfillCallback)\ =>\ void;}
\DoxyCodeLine{\ \ resetFirstInputPolyfill:\ ()\ =>\ void;}
\DoxyCodeLine{\ \ firstHiddenTime:\ number;}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29346}{}\doxysubsection{\texorpdfstring{Functions\+:}{Functions:}}\label{md_node__modules_2web-vitals_2README_autotoc_md29346}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29347}{}\doxysubsubsection{\texorpdfstring{$<$tt$>$get\+CLS()$<$/tt$>$}{<tt>getCLS()</tt>}}\label{md_node__modules_2web-vitals_2README_autotoc_md29347}

\begin{DoxyCode}{0}
\DoxyCodeLine{type\ getCLS\ =\ (onReport:\ ReportHandler,\ reportAllChanges?:\ boolean)\ =>\ void}

\end{DoxyCode}


Calculates the \href{https://web.dev/cls/}{\texttt{ CLS}} value for the current page and calls the {\ttfamily on\+Report} function once the value is ready to be reported, along with all {\ttfamily layout-\/shift} performance entries that were used in the metric value calculation. The reported value is a \href{https://heycam.github.io/webidl/\#idl-double}{\texttt{ double}} (corresponding to a \href{https://web.dev/cls/\#layout-shift-score}{\texttt{ layout shift score}}).

If the {\ttfamily report\+All\+Changes} param is {\ttfamily true}, the {\ttfamily on\+Report} function will be called any time a new {\ttfamily layout-\/shift} performance entry is dispatched, or once the final value of the metric has been determined.

{\itshape {\bfseries{Important\+:}} unlike other metrics, CLS continues to monitor changes for the entire lifespan of the page---including if the user returns to the page after it\textquotesingle{}s been hidden/backgrounded. However, since browsers often \href{https://developers.google.com/web/updates/2018/07/page-lifecycle-api\#advice-hidden}{\texttt{ will not fire additional callbacks once the user has backgrounded a page}}, {\ttfamily on\+Report} is always called when the page\textquotesingle{}s visibility state changes to hidden. As a result, the {\ttfamily on\+Report} function might be called multiple times during the same page load (see Reporting only the delta of changes for how to manage this).}\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29348}{}\doxysubsubsection{\texorpdfstring{$<$tt$>$get\+FCP()$<$/tt$>$}{<tt>getFCP()</tt>}}\label{md_node__modules_2web-vitals_2README_autotoc_md29348}

\begin{DoxyCode}{0}
\DoxyCodeLine{type\ getFCP\ =\ (onReport:\ ReportHandler,\ reportAllChanges?:\ boolean)\ =>\ void}

\end{DoxyCode}


Calculates the \href{https://web.dev/fcp/}{\texttt{ FCP}} value for the current page and calls the {\ttfamily on\+Report} function once the value is ready, along with the relevant {\ttfamily paint} performance entry used to determine the value. The reported value is a \href{https://developer.mozilla.org/en-US/docs/Web/API/DOMHighResTimeStamp}{\texttt{ {\ttfamily DOMHigh\+Res\+Time\+Stamp}}}.\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29349}{}\doxysubsubsection{\texorpdfstring{$<$tt$>$get\+FID()$<$/tt$>$}{<tt>getFID()</tt>}}\label{md_node__modules_2web-vitals_2README_autotoc_md29349}

\begin{DoxyCode}{0}
\DoxyCodeLine{type\ getFID\ =\ (onReport:\ ReportHandler,\ reportAllChanges?:\ boolean)\ =>\ void}

\end{DoxyCode}


Calculates the \href{https://web.dev/fid/}{\texttt{ FID}} value for the current page and calls the {\ttfamily on\+Report} function once the value is ready, along with the relevant {\ttfamily first-\/input} performance entry used to determine the value (and optionally the input event if using the FID polyfill). The reported value is a \href{https://developer.mozilla.org/en-US/docs/Web/API/DOMHighResTimeStamp}{\texttt{ {\ttfamily DOMHigh\+Res\+Time\+Stamp}}}.

{\itshape {\bfseries{Important\+:}} since FID is only reported after the user interacts with the page, it\textquotesingle{}s possible that it will not be reported for some page loads.}\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29350}{}\doxysubsubsection{\texorpdfstring{$<$tt$>$get\+LCP()$<$/tt$>$}{<tt>getLCP()</tt>}}\label{md_node__modules_2web-vitals_2README_autotoc_md29350}

\begin{DoxyCode}{0}
\DoxyCodeLine{type\ getLCP\ =\ (onReport:\ ReportHandler,\ reportAllChanges?:\ boolean)\ =>\ void}

\end{DoxyCode}


Calculates the \href{https://web.dev/lcp/}{\texttt{ LCP}} value for the current page and calls the {\ttfamily on\+Report} function once the value is ready (along with the relevant {\ttfamily largest-\/contentful-\/paint} performance entries used to determine the value). The reported value is a \href{https://developer.mozilla.org/en-US/docs/Web/API/DOMHighResTimeStamp}{\texttt{ {\ttfamily DOMHigh\+Res\+Time\+Stamp}}}.

If the {\ttfamily report\+All\+Changes} param is {\ttfamily true}, the {\ttfamily on\+Report} function will be called any time a new {\ttfamily largest-\/contentful-\/paint} performance entry is dispatched, or once the final value of the metric has been determined.\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29351}{}\doxysubsubsection{\texorpdfstring{$<$tt$>$get\+TTFB()$<$/tt$>$}{<tt>getTTFB()</tt>}}\label{md_node__modules_2web-vitals_2README_autotoc_md29351}

\begin{DoxyCode}{0}
\DoxyCodeLine{type\ getTTFB\ =\ (onReport:\ ReportHandler,\ reportAllChanges?:\ boolean)\ =>\ void}

\end{DoxyCode}


Calculates the \href{https://web.dev/time-to-first-byte/}{\texttt{ TTFB}} value for the current page and calls the {\ttfamily on\+Report} function once the page has loaded, along with the relevant {\ttfamily navigation} performance entry used to determine the value. The reported value is a \href{https://developer.mozilla.org/en-US/docs/Web/API/DOMHighResTimeStamp}{\texttt{ {\ttfamily DOMHigh\+Res\+Time\+Stamp}}}.

Note, this function waits until after the page is loaded to call {\ttfamily on\+Report} in order to ensure all properties of the {\ttfamily navigation} entry are populated. This is useful if you want to report on other metrics exposed by the \href{https://w3c.github.io/navigation-timing/}{\texttt{ Navigation Timing API}}.

For example, the TTFB metric starts from the page\textquotesingle{}s \href{https://www.w3.org/TR/hr-time-2/\#sec-time-origin}{\texttt{ time origin}}, which means it \href{https://developers.google.com/web/fundamentals/performance/navigation-and-resource-timing\#the_life_and_timings_of_a_network_request}{\texttt{ includes}} time spent on DNS lookup, connection negotiation, network latency, and unloading the previous document. If, in addition to TTFB, you want a metric that excludes these timings and {\itshape just} captures the time spent making the request and receiving the first byte of the response, you could compute that from data found on the performance entry\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{import\ \{getTTFB\}\ from\ 'web-\/vitals';}
\DoxyCodeLine{}
\DoxyCodeLine{getTTFB((metric)\ =>\ \{}
\DoxyCodeLine{\ \ //\ Calculate\ the\ request\ time\ by\ subtracting\ from\ TTFB}
\DoxyCodeLine{\ \ //\ everything\ that\ happened\ prior\ to\ the\ request\ starting.}
\DoxyCodeLine{\ \ const\ requestTime\ =\ metric.value\ -\/\ metric.entries[0].requestStart;}
\DoxyCodeLine{\ \ console.log('Request\ time:',\ requestTime);}
\DoxyCodeLine{\});}

\end{DoxyCode}


\+\_\+\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}\+Note\+:\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*} browsers that do not support {\ttfamily navigation} entries will fall back to using {\ttfamily performance.\+timing} (with the timestamps converted from epoch time to \href{https://developer.mozilla.org/en-US/docs/Web/API/DOMHighResTimeStamp}{\texttt{ {\ttfamily DOMHigh\+Res\+Time\+Stamp}}}). This ensures code referencing these values (like in the example above) will work the same in all browsers.\+\_\+\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29352}{}\doxysection{\texorpdfstring{Browser Support}{Browser Support}}\label{md_node__modules_2web-vitals_2README_autotoc_md29352}
The {\ttfamily web-\/vitals} code has been tested and will run without error in all major browsers as well as Internet Explorer back to version 9. However, some of the APIs required to capture these metrics are currently only available in Chromium-\/based browsers (e.\+g. Chrome, Edge, Opera, Samsung Internet).

Browser support for each function is as follows\+:


\begin{DoxyItemize}
\item {\ttfamily get\+CLS()}\+: Chromium,
\item {\ttfamily get\+FCP()}\+: Chromium, Firefox, Safari
\item {\ttfamily get\+FID()}\+: Chromium, Firefox, Safari, Internet Explorer (with the \doxylink{md_node__modules_2web-vitals_2README_how-to-use-the-polyfill}{polyfill})
\item {\ttfamily get\+LCP()}\+: Chromium
\item {\ttfamily get\+TTFB()}\+: Chromium, Firefox, Safari, Internet Explorer
\end{DoxyItemize}\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29353}{}\doxysection{\texorpdfstring{Limitations}{Limitations}}\label{md_node__modules_2web-vitals_2README_autotoc_md29353}
The {\ttfamily web-\/vitals} library is primarily a wrapper around the Web APIs that measure the Web Vitals metrics, which means the limitations of those APIs will mostly apply to this library as well.

The primary limitation of these APIs is they have no visibility into {\ttfamily \texorpdfstring{$<$}{<}iframe\texorpdfstring{$>$}{>}} content (not even same-\/origin iframes), which means pages that make use of iframes will likely see a difference between the data measured by this library and the data available in the Chrome User Experience Report (which does include iframe content).

For same-\/origin iframes, it\textquotesingle{}s possible to use the {\ttfamily web-\/vitals} library to measure metrics, but it\textquotesingle{}s tricky because it requires the developer to add the library to every frame and {\ttfamily post\+Message()} the results to the parent frame for aggregation.

{\itshape {\bfseries{Note\+:}} given the lack of iframe support, the {\ttfamily get\+CLS()} function technically measures \href{https://github.com/wicg/layout-instability\#cumulative-scores}{\texttt{ DCLS}} (Document Cumulative Layout Shift) rather than CLS, if the page includes iframes).}\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29354}{}\doxysection{\texorpdfstring{Development}{Development}}\label{md_node__modules_2web-vitals_2README_autotoc_md29354}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29355}{}\doxysubsection{\texorpdfstring{Building the code}{Building the code}}\label{md_node__modules_2web-vitals_2README_autotoc_md29355}
The {\ttfamily web-\/vitals} source code is written in Type\+Script. To transpile the code and build the production bundles, run the following command.


\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ run\ build}

\end{DoxyCode}


To build the code and watch for changes, run\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ run\ watch}

\end{DoxyCode}
\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29356}{}\doxysubsection{\texorpdfstring{Running the tests}{Running the tests}}\label{md_node__modules_2web-vitals_2README_autotoc_md29356}
The {\ttfamily web-\/vitals} code is tested in real browsers using \href{https://webdriver.io/}{\texttt{ webdriver.\+io}}. Use the following command to run the tests\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ test}

\end{DoxyCode}


To test any of the APIs manually, you can start the test server


\begin{DoxyCode}{0}
\DoxyCodeLine{npm\ run\ test:server}

\end{DoxyCode}


Then navigate to {\ttfamily \href{http://localhost:9090/test/}{\texttt{ http\+://localhost\+:9090/test/}}\texorpdfstring{$<$}{<}view\texorpdfstring{$>$}{>}}, where {\ttfamily \texorpdfstring{$<$}{<}view\texorpdfstring{$>$}{>}} is the basename of one the templates under \href{/test/views/}{\texttt{ /test/views/}}.

You\textquotesingle{}ll likely want to combine this with {\ttfamily npm run watch} to ensure any changes you make are transpiled and rebuilt.\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29357}{}\doxysection{\texorpdfstring{Integrations}{Integrations}}\label{md_node__modules_2web-vitals_2README_autotoc_md29357}

\begin{DoxyItemize}
\item \href{https://goo.gle/web-vitals-connector}{\texttt{ {\bfseries{Web Vitals Connector}}}}\+: Data Studio connector to create dashboards from \href{https://web.dev/vitals-ga4/}{\texttt{ Web Vitals data captured in Biq\+Query}}.
\item \href{https://www.simoahava.com/custom-templates/core-web-vitals/}{\texttt{ {\bfseries{Core Web Vitals Custom Tag template}}}}\+: Custom GTM template tag to \href{https://www.simoahava.com/analytics/track-core-web-vitals-in-ga4-with-google-tag-manager/}{\texttt{ add measurement handlers}} for all Core Web Vitals metrics.
\item \href{https://github.com/treosh/web-vitals-reporter}{\texttt{ \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}{\ttfamily web-\/vitals-\/reporter}\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}}\+: Java\+Script library to batch {\ttfamily on\+Report} callbacks and send data with a single request.
\end{DoxyItemize}\hypertarget{md_node__modules_2web-vitals_2README_autotoc_md29358}{}\doxysection{\texorpdfstring{License}{License}}\label{md_node__modules_2web-vitals_2README_autotoc_md29358}
\href{/LICENSE}{\texttt{ Apache 2.\+0}} 